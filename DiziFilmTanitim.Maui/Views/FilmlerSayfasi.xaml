<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
             x:Class="DiziFilmTanitim.MAUI.Views.FilmlerSayfasi"
             BackgroundColor="{StaticResource Background}">

    <Grid>
        <!-- Background -->
        <Rectangle Fill="{StaticResource PrimaryGradient}"
                   Opacity="0.05"/>

        <Grid RowDefinitions="Auto,*"
              Padding="20">

            <!-- Header -->
            <VerticalStackLayout Grid.Row="0"
                                 Spacing="15"
                                 Margin="0,20,0,20">
                <Label Text="🎬 Filmler"
                       FontSize="28"
                       FontAttributes="Bold"
                       TextColor="{StaticResource Primary}"
                       HorizontalOptions="Center"/>

                <!-- Button Text="🔄 Yenile"
                        Command="{Binding YenileCommand}"
                        Style="{StaticResource SecondaryButton}"
                        WidthRequest="120"
                        HeightRequest="40"
                        FontSize="14"
                        HorizontalOptions="Center"/ -->
            </VerticalStackLayout>

            <!-- Content -->
            <Grid Grid.Row="1">

                <!-- Loading -->
                <VerticalStackLayout IsVisible="{Binding IsBusy}"
                                     VerticalOptions="Center"
                                     Spacing="20">
                    <ActivityIndicator IsRunning="{Binding IsBusy}"
                                       Color="{StaticResource Primary}"
                                       WidthRequest="40"
                                       HeightRequest="40"/>
                    <Label Text="Filmler yükleniyor..."
                           FontSize="16"
                           TextColor="{StaticResource TextSecondary}"
                           HorizontalOptions="Center"/>
                </VerticalStackLayout>

                <!-- No Data -->
                <VerticalStackLayout IsVisible="{Binding VeriYok}"
                                     VerticalOptions="Center"
                                     Spacing="20">
                    <Border Background="{StaticResource PrimaryGradient}"
                            StrokeThickness="0"
                            StrokeShape="RoundRectangle 30"
                            WidthRequest="80"
                            HeightRequest="80"
                            HorizontalOptions="Center">
                        <Label Text="📽️"
                               FontSize="35"
                               HorizontalOptions="Center"
                               VerticalOptions="Center"/>
                    </Border>
                    <Label Text="Henüz film eklenmemiş"
                           FontSize="18"
                           FontAttributes="Bold"
                           TextColor="{StaticResource TextPrimary}"
                           HorizontalOptions="Center"/>
                    <Label Text="Film veritabanı boş görünüyor"
                           FontSize="14"
                           TextColor="{StaticResource TextSecondary}"
                           HorizontalOptions="Center"/>
                </VerticalStackLayout>

                <!-- Film Collection (İster 14: CollectionView) -->
                <CollectionView ItemsSource="{Binding Filmler}"
                                IsVisible="{Binding VeriYuklendi}"
                                SelectionMode="None"
                                Margin="0,0,0,20">

                    <CollectionView.ItemsLayout>
                        <LinearItemsLayout Orientation="Vertical"
                                           ItemSpacing="15"/>
                    </CollectionView.ItemsLayout>

                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <!-- Film Card -->
                            <Border Style="{StaticResource ModernCard}">
                                <Border.GestureRecognizers>
                                    <TapGestureRecognizer Command="{Binding Source={RelativeSource AncestorType={x:Type ContentPage}}, Path=BindingContext.FilmSecCommand}"
                                                          CommandParameter="{Binding}"/>
                                </Border.GestureRecognizers>

                                <Grid ColumnDefinitions="100,*"
                                      ColumnSpacing="15"
                                      Padding="5">

                                    <!-- Film Afişi -->
                                    <Border Grid.Column="0"
                                            BackgroundColor="{StaticResource PrimaryLight}"
                                            StrokeThickness="0"
                                            StrokeShape="RoundRectangle 8"
                                            WidthRequest="90"
                                            HeightRequest="130">
                                        <Image Aspect="AspectFill"
                                               Source="{Binding AfisUrl}"/>
                                    </Border>

                                    <!-- Film Bilgileri -->
                                    <VerticalStackLayout Grid.Column="1"
                                                         Spacing="6"
                                                         VerticalOptions="Center">

                                        <!-- Film Adı -->
                                        <Label Text="{Binding Ad}"
                                               FontSize="18"
                                               FontAttributes="Bold"
                                               TextColor="{StaticResource TextPrimary}"
                                               LineBreakMode="TailTruncation"/>

                                        <!-- Yıl ve Süre -->
                                        <HorizontalStackLayout Spacing="10">
                                            <Label Text="{Binding YapimYiliText}"
                                                   FontSize="13"
                                                   TextColor="{StaticResource Primary}"
                                                   FontAttributes="Bold"/>
                                            <Label Text="{Binding SureText}"
                                                   FontSize="13"
                                                   TextColor="{StaticResource TextSecondary}"/>
                                        </HorizontalStackLayout>

                                        <!-- Yönetmen -->
                                        <HorizontalStackLayout Spacing="5">
                                            <Label Text="🎭 Yönetmen:"
                                                   FontSize="12"
                                                   TextColor="{StaticResource TextHint}"/>
                                            <Label Text="{Binding YonetmenAdi}"
                                                   FontSize="12"
                                                   TextColor="{StaticResource TextPrimary}"
                                                   LineBreakMode="TailTruncation"/>
                                        </HorizontalStackLayout>

                                        <!-- Türler -->
                                        <HorizontalStackLayout Spacing="5">
                                            <Label Text="🏷️ Türler:"
                                                   FontSize="12"
                                                   TextColor="{StaticResource TextHint}"/>
                                            <Label Text="{Binding TurlerText}"
                                                   FontSize="12"
                                                   TextColor="{StaticResource TextSecondary}"
                                                   LineBreakMode="TailTruncation"/>
                                        </HorizontalStackLayout>

                                        <!-- Kısa Özet -->
                                        <Label Text="{Binding KisaOzet}"
                                               FontSize="12"
                                               TextColor="{StaticResource TextHint}"
                                               LineBreakMode="TailTruncation"
                                               MaxLines="2"/>

                                    </VerticalStackLayout>

                                </Grid>
                            </Border>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>

                </CollectionView>

            </Grid>

        </Grid>
    </Grid>

</ContentPage>